---
title: 如何搭建个人博客
date: 2019-10-30 15:38:28
tags:
---

>最近寻思着总要搞点事情，恰巧百度云最近搞促销，就整了个服务器来耍耍。那就整一个个人博客了呗。在搭建的过程钟遇到了许多问题，在此记录一下。

　　首先是挑选自己喜欢的博客框架，在网上看了很多。最后选的是hexo，可以自动生成一个静态博客。页面非常简洁大方，重要的还是有中文文档和很多教程，这就非常棒了是不是。

　　由于hexo是需要node支持的，所以先自己装好node环境吧，然后顺便再装一下git，然后全局安装hexo
```
npm install -g hexo
```
　　然后cd到你自己选定的目录,我新建了个blog的空文件夹
```
hexo init
```

再安装所有的依赖

```
npm install
```
现在直接执行s命令就可直接在本地启动hexo服务器了
```
hexo s
```
浏览器中打开网址[http://localhost:4000](http://localhost:4000)

ok，看起来没问题，然后这时候去github上新建一个repository
#### 注意

- 名字一定要和你github的用户名一样，而且重点是如果你名字里有大写的，那么项目名是要全部改成小写的，比如我：
    ```
    WodaQ:wodaq.github.io
    ```
    这样才是对的，这个是之前没注意到的小坑。
    
创建好了之后，打开blog文件夹里的_config.yml
拉到最下面改成这个样子：
```
deploy:
  type: git
  repository: git@github.com:WodaQ/wodaq.github.io.git
  branch: master
```
master 代表每次生成的静态文件推送到master分支
#### 注意
- repository这个我推荐填ssh方式的连接，一开始我填https的连接也可以的，但是这样每次部署代码的时候都要手动输入github的用户名和密码，非常之麻烦，ssh就可以通过添加ssh keys解决。这个也是我遇到的一个小坑。

如果没安装过hexo-deployer-git，需要手动安装一下才能正常发布到git上去，不然会报错（hexo d：ERROR Deployer not found: git），cd进blog文件夹
```
npm install hexo-deployer-git --save
```
安装好了以后执行命令：
```
hexo g
hexo d
```
学习一下，g是generate，作用是生成静态文件，d是deploy，把静态文件发布到你的git里去。
如果你没把自己的ssh keys添加到git里，那么就会提醒你输入用户名和密码。

怎么添加ssh keys 请参考这儿[如何给github添加ssh keys](www.baidu.com)

这个时候回去自己的github里，就能在master分支下看到hexo发布过来的静态文件了，部署过来的文件对应本地生成的public文件夹。

如果没有变化，就看看commit提交有没有报错，如果是正常的commit应该会有绿色的勾，如果有错误会有红色的叉，并且可以查看错误原因，我遇到过报红色叉的问题有：
```
The tag fancybox on line 77 in themes/landscape/README.md is not a recognized Liquid tag.
```
直接把landscape的README.md给删了就好

这个时候打开项目的setting，往下拉找到GitHub Pages，
会提示 
```
Your site is published at https://wodaq.github.io/
```
就可以直接点过去访问啦

然后感觉这个默认的主题有点丑，于是在网上找了一圈后选择了next，在_config.yml里找到theme字段，把landscape改成next，注意改yml文件的时候空格要小心些，不然运行命令的时候就很可能会报解析yml错误。

改好了cd到blog下安装主题模块:
```
git clone https://github.com/theme-next/hexo-theme-next themes/next
```
等待安装完成后就会发现在themes文件夹下多了一个next文件夹。

然后再次生成静态文件，再部署到git上
```
hexo g
hexo d
```
执行完成后这时候再去git页面查看一下，主题已经改成了next。

然后使用new命令新建一篇文章，比如说
```
hexo new "linux test"
```
命令会建立一篇名为linux test的md文件，然后再g，d发布一下，可以在git上看到自己新建的文章。



>那么问题来了，如何在多个终端同时管理更新这个博客呢，一般都有公司PC，家里的PC，自己的linux服务器，自己的macbook。都应该可以统一管理这个blog才对。哇这个我整了很久，看了很多文章，最后好不容易琢磨出来了,在这里再次记录一下。

先说一下大概思想，gitpage展示的页面是mster分支，master分支是我们通过g，d命令生成的public文件夹下的静态文件，那么我们另外开一个分支叫backend，用来存放所有的代码，然后如果需要在不同的终端下更新或者管理博客，只需要在本地pull一下backend的最新代码，然后在本地修改完成后，重新g，d发布到master分支就可以了。

这个操作的重点就在于，你需要在每个终端都配同样的环境，node，hexo，git之类的，那我继续开始。

去git另开一个分支backend

然后在你另一台终端，pc也好linux机器也好，我是一开始在linux上弄，然后再到本地pc上弄的。但是逻辑都一样。



首先新建一个空的文件夹blog
然后cd进去

hexo init
hexo install
然后修改_config.yml
要装都都装好，然后

git init
然后再绑定到git
git remote add origin git@github.com:WodaQ/wodaq.github.io.git

再拉取所有代码，然后丢弃本地，强制拉取远端分支。
git fetch --all
git reset --hard origin/master
git checkout -b backend origin/backend
git reset --hard origin/backend
git pull //可以省略

 
git commit -m "PC test"

git add .

git pull

全部推送到git的backend上

然后重新g,d生成新的静态文件发布到master分支上。



通过git命令把linux和PC的代码同步一下，最后再去访问博客页面应该是可以看到pc test，也可以看到linux test

还有可能会遇到

Error: EPERM: operation not permitted, mkdir 'E:\study\myself\webServer\blog\.deploy_git\css'

这个一般就是权限问题，用管理员方式打开cmd在推送
但是我用管理员方式打开依旧有问题，但是我用管理员方式打开powershell运行发现多了一个提示，我就去安装posh-git了，安装了之后还没用

INFO  Deploying: git
INFO  Clearing .deploy_git folder...
INFO  Copying files from public folder...
FATAL Something's wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html
Error: EPERM: operation not permitted, mkdir 'E:\study\myself\webServer\blog\.deploy_git\archives'
E:\study\myself\webServer\blog警告: Missing git support, install posh-git with 'Install-Module posh-git' and restart cmder.


你妈的搞不定，莫名奇妙出现的

我日tm，后面我实在没得办法选择重启一下电脑，然而在重启的时候突然弹了个错误框，然后还说正在配置我的电脑，之后就自动升级了，心里只有一万句mmp要讲。

遇事不决重启电脑就完事